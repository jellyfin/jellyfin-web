#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üõ°Ô∏è Running pre-push checks in parallel..."

# Run type-check and tests in parallel
npm run type-check > /dev/null 2>&1 &
TYPE_PID=$!

npm run test > /dev/null 2>&1 &
TEST_PID=$!

# Wait for both to finish
wait $TYPE_PID
TYPE_EXIT=$?

wait $TEST_PID
TEST_EXIT=$?

if [ $TYPE_EXIT -ne 0 ]; then
  echo "‚ùå Type check failed. Run 'npm run type-check' for details."
  exit 1
fi

if [ $TEST_EXIT -ne 0 ]; then
  echo "‚ùå Tests failed. Run 'npm run test' for details."
  exit 1
fi

echo "‚úÖ Pre-push checks passed!"